---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "hopsworksai_cluster Resource - terraform-provider-hopsworksai"
subcategory: ""
description: |-
  Use this resource to create, read, update, and delete clusters on Hopsworks.ai.
---
# hopsworksai_cluster (Resource)
Use this resource to create, read, update, and delete clusters on Hopsworks.ai.

## Example Usage

### AWS Example Usage 

```terraform
resource "hopsworksai_cluster" "cluster" {
  name    = "my-cluster-name"
  ssh_key = "my-ssh-key"

  head {
    instance_type = ""
  }

  aws_attributes {
    region               = "us-east-2"
    instance_profile_arn = "arn:aws:iam::0000000000:instance-profile/my-instance-profile"
    bucket {
      name = "my-bucket"
    }
  }

  rondb {
    management_nodes {
      instance_type = ""
    }
    data_nodes {
      instance_type = ""
    }
    mysql_nodes {
      instance_type = ""
    }
  }

  open_ports {
    ssh = true
  }

  tags = {
    "Purpose" = "testing"
  }
}
```

### Azure Example Usage 

```terraform
resource "hopsworksai_cluster" "cluster" {
  name    = "myclustername"
  ssh_key = "my-ssh-key"

  head {
    instance_type = ""
  }

  azure_attributes {
    location                       = "northeurope"
    resource_group                 = "mygroup"
    user_assigned_managed_identity = "my-identity"
    container {
      storage_account = "mystorage"
    }
    acr_registry_name = "registry-name"
  }

  rondb {
    management_nodes {
      instance_type = ""
    }
    data_nodes {
      instance_type = ""
    }
    mysql_nodes {
      instance_type = ""
    }
  }

  open_ports {
    ssh = true
  }

  tags = {
    "Purpose" = "testing"
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `head` (Block List, Min: 1, Max: 1) The configurations of the head node of the cluster. (see [below for nested schema](#nestedblock--head))
- `name` (String) The name of the cluster, must be unique.
- `rondb` (Block List, Min: 1, Max: 1) Setup a cluster with managed RonDB. (see [below for nested schema](#nestedblock--rondb))

### Optional

- `attach_public_ip` (Boolean) Attach or do not attach a public ip to the cluster. This can be useful if you intend to create a cluster in a private network. Defaults to `true`.
- `autoscale` (Block List, Max: 1) Setup auto scaling. (see [below for nested schema](#nestedblock--autoscale))
- `aws_attributes` (Block List, Max: 1) The configurations required to run the cluster on Amazon AWS. (see [below for nested schema](#nestedblock--aws_attributes))
- `azure_attributes` (Block List, Max: 1) The configurations required to run the cluster on Microsoft Azure. (see [below for nested schema](#nestedblock--azure_attributes))
- `backup_retention_period` (Number) The validity of cluster backups in days. If set to 0 cluster backups are disabled. Defaults to `0`.
- `cluster_domain_prefix` (String) Use a specific prefix in the Cluster's domain name instead of a UUID. This option is available only to users with necessary privileges.
- `collect_logs` (Boolean) Push services' logs to AWS cloud watch. Defaults to `false`.
- `custom_hosted_zone` (String) Override the default cloud.hopsworks.ai Hosted Zone. This option is available only to users with necessary privileges.
- `deactivate_hopsworksai_log_collection` (Boolean) Allow Hopsworks.ai to collect services logs to help diagnose issues with the cluster. By deactivating this option, you will not be able to get full support from our teams. Defaults to `false`.
- `gcp_attributes` (Block List, Max: 1) The configurations required to run the cluster on Google GCP. (see [below for nested schema](#nestedblock--gcp_attributes))
- `init_script` (String) A bash script that will run on all nodes during their initialization (must start with #!/usr/bin/env bash)
- `issue_lets_encrypt_certificate` (Boolean) Enable or disable issuing let's encrypt certificates. This can be used to disable issuing certificates if port 80 can not be open. Defaults to `true`.
- `managed_users` (Boolean) Enable or disable Hopsworks.ai to manage your users. Defaults to `true`.
- `open_ports` (Block List, Max: 1) Open the required ports to communicate with one of the Hopsworks services. (see [below for nested schema](#nestedblock--open_ports))
- `os` (String) The operating system to use for the instances. Supported systems are ubuntu in all regions and centos in some specific regions Defaults to `ubuntu`.
- `run_init_script_first` (Boolean) Run the init script before any other node initialization. WARNING if your initscript interfere with the following node initialization the cluster may not start properly. Make sure that you know what you are doing.
- `ssh_key` (String) The ssh key name that will be attached to this cluster.
- `tags` (Map of String) The list of custom tags to be attached to the cluster.
- `timeouts` (Block, Optional) (see [below for nested schema](#nestedblock--timeouts))
- `update_state` (String) The action you can use to start or stop the cluster. It has to be one of these values [none, start, stop]. Defaults to `none`.
- `version` (String) The version of the cluster. For existing clusters, you can change this attribute to upgrade to a newer version of Hopsworks. If the upgrade process ended up in an error state, you can always rollback to the old version by resetting this attribute to the old version. Defaults to `3.5.0`.
- `workers` (Block Set) The configurations of worker nodes. You can add as many as you want of this block to create workers with different configurations. (see [below for nested schema](#nestedblock--workers))

### Read-Only

- `activation_state` (String) The current activation state of the cluster.
- `cluster_id` (String) The Id of the cluster.
- `creation_date` (String) The creation date of the cluster. The date is represented in RFC3339 format.
- `id` (String) The ID of this resource.
- `start_date` (String) The starting date of the cluster. The date is represented in RFC3339 format.
- `state` (String) The current state of the cluster.
- `upgrade_in_progress` (List of Object) Information about ongoing cluster upgrade if any. (see [below for nested schema](#nestedatt--upgrade_in_progress))
- `url` (String) The url generated to access the cluster.

<a id="nestedblock--head"></a>
### Nested Schema for `head`

Required:

- `instance_type` (String) The instance type of the head node.

Optional:

- `disk_size` (Number) The disk size of the head node in units of GB. Defaults to `512`.
- `ha_enabled` (Boolean) Use multi head node setup for high availability. This is an experimental feature that is not supported for all users and cloud providers. Defaults to `false`.

Read-Only:

- `node_id` (String) The corresponding aws/azure instance id of the head node.
- `private_ip` (String) Private IP of the head node.


<a id="nestedblock--rondb"></a>
### Nested Schema for `rondb`

Optional:

- `api_nodes` (Block List, Max: 1) The configuration of API nodes. (see [below for nested schema](#nestedblock--rondb--api_nodes))
- `configuration` (Block List, Max: 1) The configuration of RonDB. (see [below for nested schema](#nestedblock--rondb--configuration))
- `data_nodes` (Block List, Max: 1) The configuration of RonDB data nodes. (see [below for nested schema](#nestedblock--rondb--data_nodes))
- `management_nodes` (Block List, Max: 1) The configuration of RonDB management nodes. (see [below for nested schema](#nestedblock--rondb--management_nodes))
- `mysql_nodes` (Block List, Max: 1) The configuration of MySQL nodes. (see [below for nested schema](#nestedblock--rondb--mysql_nodes))
- `single_node` (Block List, Max: 1) The configuration of All in one RonDB where the management node, the data node, and the mysqld services are colocated in a single node. (see [below for nested schema](#nestedblock--rondb--single_node))

<a id="nestedblock--rondb--api_nodes"></a>
### Nested Schema for `rondb.api_nodes`

Required:

- `instance_type` (String) The instance type of the RonDB API node.

Optional:

- `count` (Number) The number of API nodes. Defaults to `0`.
- `disk_size` (Number) The disk size of API nodes in units of GB Defaults to `30`.

Read-Only:

- `private_ips` (List of String) Array containing the private IPs of the nodes


<a id="nestedblock--rondb--configuration"></a>
### Nested Schema for `rondb.configuration`

Optional:

- `general` (Block List, Max: 1) The general configurations of RonDB. (see [below for nested schema](#nestedblock--rondb--configuration--general))
- `ndbd_default` (Block List, Max: 1) The configuration of RonDB data nodes. (see [below for nested schema](#nestedblock--rondb--configuration--ndbd_default))

<a id="nestedblock--rondb--configuration--general"></a>
### Nested Schema for `rondb.configuration.general`

Optional:

- `benchmark` (Block List, Max: 1) The configurations required to benchmark RonDB. (see [below for nested schema](#nestedblock--rondb--configuration--general--benchmark))

<a id="nestedblock--rondb--configuration--general--benchmark"></a>
### Nested Schema for `rondb.configuration.general.benchmark`

Optional:

- `grant_user_privileges` (Boolean) This allow API nodes to have user privileges access to RonDB. This is needed mainly for benchmarking and for that you need API nodes. Defaults to `false`.



<a id="nestedblock--rondb--configuration--ndbd_default"></a>
### Nested Schema for `rondb.configuration.ndbd_default`

Optional:

- `replication_factor` (Number) The number of replicas created by RonDB. Set > 1 for high availability. Defaults to `2`.



<a id="nestedblock--rondb--data_nodes"></a>
### Nested Schema for `rondb.data_nodes`

Required:

- `instance_type` (String) The instance type of the RonDB data node.

Optional:

- `count` (Number) The number of data nodes. Notice that the number of RonDB data nodes have to be multiples of the replication_factor. Defaults to `2`.
- `disk_size` (Number) The disk size of data nodes in units of GB Defaults to `512`.

Read-Only:

- `private_ips` (List of String) Array containing the private IPs of the nodes


<a id="nestedblock--rondb--management_nodes"></a>
### Nested Schema for `rondb.management_nodes`

Required:

- `instance_type` (String) The instance type of the RonDB management node.

Optional:

- `count` (Number) The number of management nodes. Defaults to `1`.
- `disk_size` (Number) The disk size of management nodes in units of GB Defaults to `30`.

Read-Only:

- `private_ips` (List of String) Array containing the private IPs of the nodes


<a id="nestedblock--rondb--mysql_nodes"></a>
### Nested Schema for `rondb.mysql_nodes`

Required:

- `instance_type` (String) The instance type of the RonDB MySQL node.

Optional:

- `arrow_flight_with_duckdb` (Boolean) Enable or disable ArrowFight server with DuckDB to speed up different feature store operations for external python clients. Defaults to `false`.
- `count` (Number) The number of MySQL nodes. Defaults to `1`.
- `disk_size` (Number) The disk size of MySQL nodes in units of GB Defaults to `128`.

Read-Only:

- `private_ips` (List of String) Array containing the private IPs of the nodes


<a id="nestedblock--rondb--single_node"></a>
### Nested Schema for `rondb.single_node`

Required:

- `instance_type` (String) The instance type of the All in one RonDB node. You should use one of the supported instance types for RonDB data node.

Optional:

- `disk_size` (Number) The disk size of data nodes in units of GB Defaults to `512`.

Read-Only:

- `private_ips` (List of String) Array containing the private IPs of the nodes



<a id="nestedblock--autoscale"></a>
### Nested Schema for `autoscale`

Required:

- `non_gpu_workers` (Block List, Min: 1, Max: 1) Setup auto scaling for non gpu nodes. (see [below for nested schema](#nestedblock--autoscale--non_gpu_workers))

<a id="nestedblock--autoscale--non_gpu_workers"></a>
### Nested Schema for `autoscale.non_gpu_workers`

Required:

- `instance_type` (String) The instance type to use while auto scaling.

Optional:

- `disk_size` (Number) The disk size to use while auto scaling Defaults to `512`.
- `downscale_wait_time` (Number) The time to wait before removing unused resources. Defaults to `300`.
- `max_workers` (Number) The maximum number of workers created by auto scaling. Defaults to `10`.
- `min_workers` (Number) The minimum number of workers created by auto scaling. Defaults to `0`.
- `spot_config` (Block List, Max: 1) The configuration to use spot instances (see [below for nested schema](#nestedblock--autoscale--non_gpu_workers--spot_config))
- `standby_workers` (Number) The percentage of workers to be always available during auto scaling. If you set this value to 0 new workers will only be added when a job or a notebook requests the resources. This attribute will not be taken into account if you set the minimum number of workers to 0 and no resources are used in the cluster, instead, it will start to take effect as soon as you start using resources. Defaults to `0.5`.

<a id="nestedblock--autoscale--non_gpu_workers--spot_config"></a>
### Nested Schema for `autoscale.non_gpu_workers.spot_config`

Optional:

- `fall_back_on_demand` (Boolean) Fall back to on demand instance if unable to allocate a spot instance Defaults to `true`.
- `max_price_percent` (Number) The maximum spot instance price in percentage of the on-demand price. Defaults to `100`.




<a id="nestedblock--aws_attributes"></a>
### Nested Schema for `aws_attributes`

Required:

- `instance_profile_arn` (String) The ARN of the AWS instance profile that the cluster will be started with.
- `region` (String) The AWS region where the cluster will be created.

Optional:

- `bucket` (Block List, Max: 1) The bucket configurations. (see [below for nested schema](#nestedblock--aws_attributes--bucket))
- `ebs_encryption` (Block List, Max: 1) The EBS disk encryption configuration. (see [below for nested schema](#nestedblock--aws_attributes--ebs_encryption))
- `ecr_registry_account_id` (String) The account id used for ECR. Defaults to the user's account id, inferred from the instance profille ARN.
- `eks_cluster_name` (String) The name of the AWS EKS cluster.
- `head_instance_profile_arn` (String) The ARN of the AWS instance profile that the head node will be started with.
- `network` (Block List, Max: 1) The network configurations. (see [below for nested schema](#nestedblock--aws_attributes--network))

<a id="nestedblock--aws_attributes--bucket"></a>
### Nested Schema for `aws_attributes.bucket`

Required:

- `name` (String) The name of the S3 bucket that the cluster will use to store data in.

Optional:

- `acl` (Block List, Max: 1) The ACL configurations. (see [below for nested schema](#nestedblock--aws_attributes--bucket--acl))
- `encryption` (Block List, Max: 1) The server-side encryption configurations. (see [below for nested schema](#nestedblock--aws_attributes--bucket--encryption))

<a id="nestedblock--aws_attributes--bucket--acl"></a>
### Nested Schema for `aws_attributes.bucket.acl`

Optional:

- `bucket_owner_full_control` (Boolean) If ACL is enabled, allow the bucket owner to have full access control on new objects in the bucket.


<a id="nestedblock--aws_attributes--bucket--encryption"></a>
### Nested Schema for `aws_attributes.bucket.encryption`

Optional:

- `bucket_key` (Boolean) Enable or disable the usage of bucket key. Enabling this option (in case of SSE-KMS) would reduce the cost of SSE-KMS.
- `kms_type` (String) The Key Management Service (KMS) type. This option is required for the encryption mode SSE-KMS.
- `mode` (String) The encryption type.
- `user_key_arn` (String) The ARN of the user encryption key in KMS.



<a id="nestedblock--aws_attributes--ebs_encryption"></a>
### Nested Schema for `aws_attributes.ebs_encryption`

Optional:

- `kms_key` (String) The KMS key to be used for encryption can be specified by its alias, ID or ARN. Leaving the KMS key unspecified results in the EC2 default encryption key being used.


<a id="nestedblock--aws_attributes--network"></a>
### Nested Schema for `aws_attributes.network`

Required:

- `subnet_id` (String) The subnet id.
- `vpc_id` (String) The VPC id.

Optional:

- `security_group_id` (String) The security group id.



<a id="nestedblock--azure_attributes"></a>
### Nested Schema for `azure_attributes`

Required:

- `location` (String) The location where the cluster will be created.
- `resource_group` (String) The resource group where the cluster will be created.
- `user_assigned_managed_identity` (String) The azure user assigned managed identity that the cluster will be started with.

Optional:

- `acr_registry_name` (String) The name of the ACR registry.
- `aks_cluster_name` (String) The name of the AKS cluster.
- `container` (Block List, Max: 1) The container configurations. (see [below for nested schema](#nestedblock--azure_attributes--container))
- `network` (Block List, Max: 1) The network configurations. (see [below for nested schema](#nestedblock--azure_attributes--network))

<a id="nestedblock--azure_attributes--container"></a>
### Nested Schema for `azure_attributes.container`

Required:

- `storage_account` (String) The azure storage account that the cluster will use to store data in.

Optional:

- `encryption` (Block List, Max: 1) The server-side encryption configurations. (see [below for nested schema](#nestedblock--azure_attributes--container--encryption))
- `name` (String) The name of the azure storage container that the cluster will use to store data in. If not specified, it will be automatically generated.

<a id="nestedblock--azure_attributes--container--encryption"></a>
### Nested Schema for `azure_attributes.container.encryption`

Optional:

- `mode` (String) The encryption type.



<a id="nestedblock--azure_attributes--network"></a>
### Nested Schema for `azure_attributes.network`

Required:

- `subnet_name` (String) The subnet name.
- `virtual_network_name` (String) The virtual network name.

Optional:

- `resource_group` (String) The resource group where the network resources reside. If not specified, the azure_attributes/resource_group will be used.
- `search_domain` (String) The search domain to use for node address resolution. If not specified it will use the Azure default one (internal.cloudapp.net).
- `security_group_name` (String) The security group name.



<a id="nestedblock--gcp_attributes"></a>
### Nested Schema for `gcp_attributes`

Required:

- `project_id` (String) The GCP project where the cluster will be created.
- `region` (String) The GCP region where the cluster will be created.
- `service_account_email` (String) The service account email address that the cluster will be started with.
- `zone` (String) The GCP region where the cluster will be created.

Optional:

- `bucket` (Block List, Max: 1) The bucket configurations. (see [below for nested schema](#nestedblock--gcp_attributes--bucket))
- `disk_encryption` (Block List, Max: 1) The disk encryption configuration. (see [below for nested schema](#nestedblock--gcp_attributes--disk_encryption))
- `gke_cluster_name` (String) The name of the Google GKE cluster.
- `network` (Block List, Max: 1) The network configurations. (see [below for nested schema](#nestedblock--gcp_attributes--network))

<a id="nestedblock--gcp_attributes--bucket"></a>
### Nested Schema for `gcp_attributes.bucket`

Required:

- `name` (String) The name of the GCP storage bucket that the cluster will use to store data in.


<a id="nestedblock--gcp_attributes--disk_encryption"></a>
### Nested Schema for `gcp_attributes.disk_encryption`

Optional:

- `customer_managed_encryption_key` (String) Specify a customer-managed encryption key to be used for encryption of local storage. The key has to use the format: projects/PROJECT_ID/locations/REGION/keyRings/KEY_RING/cryptoKeys/KEY.


<a id="nestedblock--gcp_attributes--network"></a>
### Nested Schema for `gcp_attributes.network`

Required:

- `network_name` (String) The network name.
- `subnetwork_name` (String) The subnetwork name.



<a id="nestedblock--open_ports"></a>
### Nested Schema for `open_ports`

Optional:

- `feature_store` (Boolean) Open the required ports to access the feature store from outside Hopsworks. Defaults to `false`.
- `kafka` (Boolean) Open the required ports to access kafka from outside Hopsworks. Defaults to `false`.
- `online_feature_store` (Boolean) Open the required ports to access the online feature store from outside Hopsworks. Defaults to `false`.
- `ssh` (Boolean) Open the ssh port (22) to allow ssh access to your cluster. Defaults to `false`.


<a id="nestedblock--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String)
- `delete` (String)
- `read` (String)
- `update` (String)


<a id="nestedblock--workers"></a>
### Nested Schema for `workers`

Required:

- `instance_type` (String) The instance type of the worker nodes.

Optional:

- `count` (Number) The number of worker nodes. Defaults to `1`.
- `disk_size` (Number) The disk size of worker nodes in units of GB Defaults to `512`.
- `spot_config` (Block List, Max: 1) The configuration to use spot instances (see [below for nested schema](#nestedblock--workers--spot_config))

Read-Only:

- `private_ips` (List of String) Array containing the private IPs of the nodes

<a id="nestedblock--workers--spot_config"></a>
### Nested Schema for `workers.spot_config`

Optional:

- `fall_back_on_demand` (Boolean) Fall back to on demand instance if unable to allocate a spot instance Defaults to `true`.
- `max_price_percent` (Number) The maximum spot instance price in percentage of the on-demand price. Defaults to `100`.



<a id="nestedatt--upgrade_in_progress"></a>
### Nested Schema for `upgrade_in_progress`

Read-Only:

- `from_version` (String)
- `to_version` (String)

## Import

Import is supported using the following syntax:
```shell
terraform import hopsworksai_cluster.my_cluster <cluster_id>
```
